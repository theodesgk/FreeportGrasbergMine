#!/psw/cpp

/* Speed Alert Enhancements */
symbol SpeedLimit

/* Set SA_TYPE */
#ifdef DELITE
#	define SATYPELITE
	symbol SA_TYPE _DELITE_
#elif !#arch(pe)
#	define SATYPELITE
	symbol SA_TYPE CGC
#else
	symbol SA_TYPE DE
#endif

/* DELITE and CGC Macros */
#ifdef SATYPELITE
macro SpeedPost w0.speedLbl label:$(SpeedLimit);w0.speedOutline map:y;w0.speedLbl map:y;WinMgr after:10:SpeedOff
macro SpeedOff w0.speedOutline map:n;w0.speedLbl map:n;w0.speedOutline label:""
macro SpeedShow w0.speedLbl label:$(SpeedLimit);w0.speedOutline label:$(SpeedMsg01);w0.speedOutline map:y;w0.speedLbl map:y
macro SpeedOver  KBEEP 1;SpeedShow;WinMgr after:2:SpeedOver2
macro SpeedOver2 w0.speedLbl map:n;WinMgr after:2:SpeedOver3
macro SpeedOver3 KBEEP 1;w0.speedLbl map:y;WinMgr after:2:SpeedOver4
macro SpeedOver4 w0.speedLbl map:n;WinMgr after:2:SpeedOver5
macro SpeedOver5 KBEEP 1;w0.speedLbl map:y;WinMgr after:2:SpeedOver6
macro SpeedOver6 w0.speedLbl map:n;WinMgr after:2:SpeedOff
#else
/* DE Macros */
symbol	ShowOvrMsg	0
symbol	ShowOvrCnt	0
macro	SpeedPost	""
macro	SpeedOver	KBEEP 1;ShowOvrMsg 1;ShowOvrCnt 1;OverDisp
macro	PollSpeed	eq? $(ShowOvrMsg) 0 SpeedDisp;\
                        eq? $(ShowOvrMsg) 1 SpeedChkCnt
macro	SpeedDisp	setGpsVel;\
                        eq? "$(SpeedUnit)" "mph" UseMph; \
                        eq? "$(SpeedUnit)" "km/h" UseKph; \
                        UpdateStatBar "Speed" "$(velocity)\n$(SpUnitDisplay)"
macro	SpeedChkCnt	ShowOvrCnt $(+ $(ShowOvrCnt) 1);\
                        eq? $(max $(ShowOvrCnt) 16) $(ShowOvrCnt) EndSpeedOver
macro	SpeedShowOn	ShowOvrMsg 1
macro	SpeedShowOff	ShowOvrMsg 0	
#ifdef	VSIXTWO
symbol	SA_VER 6.2
macro	EndSpeedOver	ShowOvrMsg 0;ShowOvrCnt 0;SpeedDisp 
macro	OverDisp	UpdateStatBar "Speed" "$(SpeedMsg01)"
#else
symbol	SA_VER 6.3
macro	EndSpeedOver	ShowOvrMsg 0;ShowOvrCnt 0;UpdateStatBarClr "Speed" "White";UpdateStatBarSize "Speed" "small";UpdateStatBarImg "3" "";SpeedDisp 
macro	OverDisp	UpdateStatBarClr "Speed" "Black";UpdateStatBarSize "Speed" "medium";UpdateStatBarImg "3" "spdalert";UpdateStatBar "Speed" "$(SpeedLimit)"
#endif
#endif

#define LANG_FILE	<SpeedAlert/LANGUAGE/Macro.cfg>
#include LANG_FILE
