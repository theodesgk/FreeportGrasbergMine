%!/psw/cpp
/*
 * * * * * * * * * * * * * * * * * * *
 *  DISPATCH Real-Time Firmware Module
 * Copyright (c) Modular Mining Systems, 1982-1995
 *               All Rights Reserved
 *  $RCSfile: Macro.cfg,v $
 * $Revision: 1.7 $
 *   $Author: zambetis $
 *     $Date: 2009/08/07 00:39:03 $
 *    $State: Exp $
 *   Purpose: Macro configuration file for Backhoe systems
 * * * * * * * * * * * * * * * * * * *
 */

symbol	enableAlarm	1
symbol	dualView	1
symbol	desElev		""

/* there's a much better way to update the gauges, by linking them directly to the
 * output of the materials object but let's do it consistently with the old code first
 *
 * always show project based elevation difference on gauge unless specifically directed
 * to show the material model based elevation control difference
 */
macro	ShowElev 	w0.elev label:$(bucket teethZ);\
			desElev $(ComMgr bucketDesiredElev);\
			ne? $(desElev) ? indicatorVal $(- $(ComMgr bucketElev) $(ComMgr bucketDesiredElev));\
			eq? $(desElev) ? indicatorVal $(materials delta);\
			eq? "$(actwin)" "w0" ShowElevW0;\
			eq? "$(actwin)" "hp" ShowElevHp

macro	selectMaterial	hp.matl label:$1

macro	undercutAlarm 	eq? $(enableAlarm) 1 w0.Text write:"WARNING: Undercut!\n"

macro	showSideView	hp.CADCanvas map:n;\
			hp.sideview map:n;\
			hp.sideview geom:x:8:y:104:w:524:h:316:bw:2 selMacro:showDualView;\
			hp.sideview horzLevel:25;\
			hp.sideview map:y

macro	showTopView	hp.CADCanvas map:n;\
			hp.sideview map:n;\
                        hp.CADCanvas geom:x:10:y:104:h:316:w:526:bw:2 action:showDualView;\
			hp.CADCanvas viewbounds:x:128:y:168:w:256:h:177;\
			hp.CADCanvas map:y

macro	showDualView	hp.CADCanvas map:n;\
			hp.sideview map:n;\
			hp.sideview geom:x:271:y:104:w:261:h:316:bw:2 horzLevel:0 selMacro:showSideView;\
                        hp.CADCanvas geom:x:9:y:104:w:261:h:316:bw:2 action:showTopView;\
			hp.CADCanvas viewbounds:x:0:y:212:w:80:h:89;\
			hp.CADCanvas map:y;\
			hp.sideview map:y

macro	setBackhoeView 	eq? $(dualView) 1 showDualView;\
	  		eq? $(dualView) 0 showTopView

macro  	showHP  	setBackhoeView;\
			ne? $(actwin) hp WinMgr window:hp
