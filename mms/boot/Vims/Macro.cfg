%!/psw/cpp
/*
 * TACM Vims configuration file. 
 * SGK 02/05/15
 */

in    VIMS-XMIT       0x16b d[d]      setParam;sendRpc
out     VIMS-DIPPER     0x160 d       sendto up
out   VIMS-DATA       0x16c [d]       sendto up
out   VIMS-EVENT      0x164 db,v      sendto up
out   VIMS-EDEACK     0x16a db,v      sendto up
out     VIMS-LOAD       0x161 d         sendto up
out     VIMS-CYCLE      0x162 [d]       sendto up
in      VIMS-INFO       0x163 [d],[d]   sendto Vims
in      VIMS-HOURS      0x165 v,l       sendto Vims
in      VIMS-OPERID     0x166 s         sendto Vims
out     VIMS-AUTO       0x167 [b],d     return 0
in      VIMS-SEND       0x168 dd,[b]    sendto Vims
in      VIMS-CMND       0x169 [b]       sendto Vims

symbol	Xmit		0
symbol	Chans		0
symbol	Timer		0
stack	4096

macro	setParam	Xmit $(* 1000 $1);Chans $2
macro	sendRpc		VIMS-DATA $(VIMS-INFO $(Chans))
macro	initTimer	sendRpc;Timer $(Xmit)	
macro	checkTimer	eq? $(max $(Timer) 0) 0 initTimer;Timer $(- $(Timer) 1000)
macro	checkVims	ne? $(max $(Xmit) 0) 0 checkTimer
