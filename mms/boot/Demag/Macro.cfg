%!/psw/cpp
/*
 * The DEMAG system sends a funky alarm description message
 * like the following:
 *
 *	$MComing :   9 at 19.06.96    19:54:22
 *			OR
 *	$MGoing :   9 at 19.06.96    19:54:22
 *	$h:   00:00 Engine shutdown: too high
 *	coolant temperature            @S09/0010
 *
 * In the interface, we define the `$MComing', `$MGoing', and `$h:'
 * RPCs such that after receiving the `$h:' engine hours the interface
 * transmits a single DEMAG-ALARM RPC.
 */
symbol	DemagCode	-1
symbol	DemagStat	0
out	$MComing	0	sd	DemagStat 1;DemagCode $2
out	$MGoing		0	sd	DemagStat 0;DemagCode $2
out	$h		0	ss	DEMAG-ALARM $(DemagStat) $(DemagCode) $1
out	#		0	v	DEMAG-ALARM $(DemagStat) $(DemagCode) ""
out	DEMAG-ALARM	0x428	bds	ne? $2 -1 sendto up;DemagCode -1
