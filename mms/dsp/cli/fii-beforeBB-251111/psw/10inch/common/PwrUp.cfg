#!/psw/cpp
/*
 * * * * * * * * * * * * * * * * * * *
 *  DISPATCH Real-Time Firmware Module
 * Copyright (c) Modular Mining Systems, 1982-2011
 *               All Rights Reserved
 *  $RCSfile: PwrUp.cfg,v $
 * $Revision: 1.4 $
 *   $Author: schultes $
 *     $Date: 2018/01/22 19:49:12 $
 *    $State: Exp $
 * * * * * * * * * * * * * * * * * * *
 */

/*
 * File used to determine device specifications.
 * Naming convention for variables is as follows:
 *
 *	DEVHW	-	Device Hardware Specification 
 *	DEVBC	-	Device Boot Code Specification
 *	DEVOP	- 	Mobile Device Boot Code Option
 *
 * Use code below to build these variables to be sent to central.
 * Each will be built into 32 bit int flag.
 * Use bit flags to define each setting.
 *
 */

/* Hardware Specifications */

#define DEVHW_PTXB		1
#define DEVHW_PTXC		2

#define DEVHW_7INCH		8
#define DEVHW_10INCH		16

#define DEVHW_PORTRAIT		32
#define DEVHW_LANDSCAPE		64

/* Software Specifications */

#define DEVBC_AUXIL		1
#define DEVBC_CRUSHER		2
#define DEVBC_EXCAV		3
#define DEVBC_TRUCK		4
#define DEVBC_WTRUCK		5
#define DEVBC_DRILL		6
#define DEVBC_FOREMAN		7
#define DEVBC_FUELBAY		8

#define DEVBC_NOPS		64
#define DEVBC_PS		128
#define DEVBC_ENHANCEPS		192

#define DEVBC_DE		256
#define DEVBC_DELITE		512

#define DEVBC_NEWUI		1024
#define DEVBC_CLASSICUI		2048
#define DEVBC_UGUI		3072

#define DEVBC_ENGLISH		4096
#define DEVBC_FRENCH		8192
#define DEVBC_HINDI		12288
#define DEVBC_INDONESIAN	16384
#define DEVBC_MONGOLIAN		20480
#define DEVBC_PORTUGUESE	28672
#define DEVBC_RUSSIAN		32768
#define DEVBC_SPANISH		36864	
#define DEVBC_BULGARIAN		40960
#define DEVBC_TURKISH		45056

/* Loaded Options */

#define DEVOP_AUTOHAULCYCLE	1
#define DEVOP_AUXPROD		2
#define DEVOP_AUXTASK		4
#define DEVOP_IDLEMON		8
#define DEVOP_GPSTAGACT		16
#define DEVOP_SPEEDALERT	32
#define DEVOP_SPEEDMSG		64
#define DEVOP_STOREFORWARD	128
#define DEVOP_TIRESAVER		256
#define DEVOP_SPEEDALERTPLUS	512
	
symbol DEVHW	0
symbol DEVBC	0
symbol DEVOP	0

/********************************************************
 * 
 * Hardware Platform Specifications
 *
 ********************************************************/

/* Mobile Device */
#if #arch(ptxb)
#	define adddevver DEVHW $(+ $(DEVHW) DEVHW_PTXB)
#elif #arch(ptxc)
#	define adddevver DEVHW $(+ $(DEVHW) DEVHW_PTXC)
#else 
#	define adddevver ""
#endif

/* Screen Size */
#if defined LARGEUI
#	define adddevsize DEVHW $(+ $(DEVHW) DEVHW_10INCH)
#else
#	define adddevsize DEVHW $(+ $(DEVHW) DEVHW_7INCH)
#endif

/* Screen Orientation */
#if defined PORTRAIT
#	define adddevorient DEVHW $(+ $(DEVHW) DEVHW_PORTRAIT)
#else
#	define adddevorient DEVHW $(+ $(DEVHW) DEVHW_LANDSCAPE)
#endif

/********************************************************
 * 
 * Setup Boot Code Specifications
 *
 ********************************************************/

/* Determine Equipment Class */
/* For some reason elif does not work here. Use seperate if clauses */

#if #app(auxil)
#	define addeqclass DEVBC $(+ $(DEVBC) DEVBC_AUXIL)
#elif #app(excav)
#	define addeqclass DEVBC $(+ $(DEVBC) DEVBC_EXCAV)
#elif #app(crusher)
#	define addeqclass DEVBC $(+ $(DEVBC) DEVBC_CRUSHER)
#elif #app(truck)
#	define addeqclass DEVBC $(+ $(DEVBC) DEVBC_TRUCK)
#elif #app(wtruck)
#	define addeqclass DEVBC $(+ $(DEVBC) DEVBC_WTRUCK)
#elif #app(drill)
#	define addeqclass DEVBC $(+ $(DEVBC) DEVBC_DRILL)
#elif #app(foreman)
#	define addeqclass DEVBC $(+ $(DEVBC) DEVBC_FOREMAN)
#elif #app(fuelbay)
#	define addeqclass DEVBC $(+ $(DEVBC) DEVBC_FUELBAY)
#else 
#	define addeqclass ""
#endif
*/
/* Determine Application Version */
#if defined DELITE
#	define addapp DEVBC $(+ $(DEVBC) DEVBC_DELITE)
#else
#	define addapp DEVBC $(+ $(DEVBC) DEVBC_DE)
#endif

/* Determine UI Version */
#if defined NEWUI
#	define adduiver DEVBC $(+ $(DEVBC) DEVBC_NEWUI)
#elif defined CLASSICUI
#	define adduiver DEVBC $(+ $(DEVBC) DEVBC_CLASSICUI)
#elif defined UGUI
#	define adduiver DEVBC $(+ $(DEVBC) DEVBC_UGUI)
#else
#	define adduiver ""
#endif

/* Determine Equipment Language */
#if #language(English)
#	define	addlang DEVBC $(+ $(DEVBC) DEVBC_ENGLISH)
#elif #language(French)
#	define	addlang DEVBC $(+ $(DEVBC) DEVBC_FRENCH)
#elif #language(Hindi)
#	define	addlang DEVBC $(+ $(DEVBC) DEVBC_HINDI)
#elif #language(Indonesian)
#	define	addlang DEVBC $(+ $(DEVBC) DEVBC_INDONESIAN)
#elif #language(Mongolian)
#	define	addlang DEVBC $(+ $(DEVBC) DEVBC_MONGOLIAN)
#elif #language(Portuguese)
#	define	addlang DEVBC $(+ $(DEVBC) DEVBC_PORTUGUESE)
#elif #language(Russian)
#	define	addlang DEVBC $(+ $(DEVBC) DEVBC_RUSSIAN)
#elif #language(Spanish)
#	define	addlang DEVBC $(+ $(DEVBC) DEVBC_SPANISH)
#elif #language(Bulgarian)
#	define	addlang DEVBC $(+ $(DEVBC) DEVBC_BULGARIAN)
#elif #language(Turkish)
#	define	addlang DEVBC $(+ $(DEVBC) DEVBC_TURKISH)
#else
#	define	addlang "" 
#endif

#if defined PSCHECK &&  #pscheck(yes)
#	if defined ENHANCEPS
#		define addpstype DEVBC $(+ $(DEVBC) DEVBC_ENHANCEPS)
#	else
#		define addpstype DEVBC $(+ $(DEVBC) DEVBC_PS)
#	endif
#else
#	define addpstype DEVBC $(+ $(DEVBC) DEVBC_NOPS)
#endif


/*********************************************************
 * 
 * Setup Specifications for Mobile Options Loaded 
 *
 ********************************************************/

#if #option(AutoHaulCycle)
#	define	addahc DEVOP $(+ $(DEVOP) DEVOP_AUTOHAULCYCLE)
#else
#	define	addahc ""
#endif

#if #option(AuxProd)
#	define	addauxprod DEVOP $(+ $(DEVOP) DEVOP_AUXPROD)
#else
#	define	addauxprod ""
#endif

#if #option(AuxTask)
#	define	addat DEVOP $(+ $(DEVOP) DEVOP_AUXTASK)
#else
#	define	addat ""
#endif

#if #option(IdleMon)
#	define	addim DEVOP $(+ $(DEVOP) DEVOP_IDLEMON)
#else
#	define	addim ""
#endif

#if #option(GpsTagAct)
#	define	addgpsta DEVOP $(+ $(DEVOP) DEVOP_GPSTAGACT)
#else
#	define	addgpsta ""
#endif

#if #option(SpeedAlert)
#	define	addsa DEVOP $(+ $(DEVOP) DEVOP_SPEEDALERT)
#else
#	define	addsa ""
#endif

#if #option(SpeedAlertPlus)
#	define	addsap DEVOP $(+ $(DEVOP) DEVOP_SPEEDALERTPLUS)
#else
#	define	addsap ""
#endif

#if #option(SpeedMsg)
#	define	addsm DEVOP $(+ $(DEVOP) DEVOP_SPEEDMSG)
#else
#	define	addsm ""
#endif

#if #option(StoreForward)
#	define	addsf DEVOP $(+ $(DEVOP) DEVOP_STOREFORWARD)
#else
#	define	addsf ""
#endif

#if #option(TireSaver)
#	define	addts DEVOP $(+ $(DEVOP) DEVOP_TIRESAVER)
#else
#	define	addts ""
#endif

/*********************************************************
 * 
 * Build and Send PowerUp
 *
 ********************************************************/

macro Eval_DEVHW	DEVHW 0;\
			adddevver;\
			adddevsize;\
			adddevorient;

macro Eval_DEVBC	DEVBC 0;\
			addeqclass;\
			addapp;\
			adduiver;\
			addlang;\
			addpstype;

macro Eval_DEVOP 	DEVOP 0;\
			addahc;\
			addauxprod;\
			addat;\
			addim;\
			addgpsta;\
			addsa;\
			addsap;\
			addsm;\
			addsf;\
			addts;

macro Eval_DEV		Eval_DEVHW; Eval_DEVBC; Eval_DEVOP

#include <Version.h>

macro	SendPowerUp	Macro PWRUP:DEMAJOR.DEMINOR.DEMAINT-vVERSION-$(DEVHW)-$(DEVBC)-$(DEVOP)

macro   ClassPowerUp    ""
macro   PowerUp         Eval_DEV;\
                        eq? $(OMS connected) yes SendPowerUp;\
			eq? $(OMS connected) no  WinMgr after:1:PowerUp;\
                        w0.NextAct label:"$(UpdatePanelLbl)";\
                        ClassPowerUp

/*      EOF      */
